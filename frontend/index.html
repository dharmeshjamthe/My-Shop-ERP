<!DOCTYPE html>
<html>
<head>
<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#00c6ff">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enjoy Point ERP - Login</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI;}
body{
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:linear-gradient(135deg,#0f2027,#203a43);
    color:white;
}
.card{
    background:rgba(255,255,255,0.05);
    backdrop-filter:blur(15px);
    padding:35px;
    border-radius:15px;
    width:350px;
    text-align:center;
}
input{
    width:100%;
    padding:10px;
    margin-top:8px;
    border-radius:6px;
    border:none;
}
button{
    margin-top:15px;
    padding:10px;
    width:100%;
    border:none;
    border-radius:6px;
    background:#00c6ff;
    color:white;
    cursor:pointer;
}
button:hover{opacity:0.9;}
.error{color:#ff4b2b;margin-top:10px;}
</style>
</head>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/static/sw.js')
    .then(() => console.log("Service Worker Registered"))
    .catch(err => console.log("SW error", err));
}
</script>
<body>

<div class="card">
<h2>ENJOY POINT ERP</h2>

<input type="text" id="username" placeholder="Username">
<input type="password" id="password" placeholder="Password">

<button onclick="login()">Login</button>
<p id="error" class="error"></p>
</div>

<script>
const BASE_URL="https://my-shop-erp.onrender.com";

async function login(){
    const formData=new URLSearchParams();
    formData.append("username",username.value);
    formData.append("password",password.value);

    const res=await fetch(BASE_URL+"/login",{
        method:"POST",
        headers:{"Content-Type":"application/x-www-form-urlencoded"},
        body:formData
    });

    const data=await res.json();

    if(res.ok){
        localStorage.setItem("token",data.access_token);
        window.location.href="dashboard.html";
    }else{
        document.getElementById("error").innerText=data.detail;
    }
}
</script>

</body>
</html>